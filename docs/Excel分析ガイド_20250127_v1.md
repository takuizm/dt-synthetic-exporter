# Excel分析ガイド（実務担当者向け）
作成日: 2025-01-27  
対象: Excel利用者・分析担当者  

## 目的

本ガイドでは、Dynatrace Synthetic Browser監視データエクスポーターで生成されたCSVファイルをExcelで開き、Webサイトパフォーマンス分析を行う手順を説明します。

プログラミング知識を必要とせず、Excel基本操作のみで高度な分析が可能です。

## ファイル準備

### CSVファイルの確認

1. **ファイル場所**: プロジェクトフォルダの `output/` ディレクトリを確認
2. **ファイル名**: `ultimate_browser_results_YYYYMMDD_HHMMSS.csv` 形式のファイル
3. **最新ファイル**: 日付・時刻が最新のものが最新の分析結果

### Excelでの開き方

**手順1: Excelから開く**
1. Excelを起動
2. ファイル → 開く → `ultimate_browser_results_*.csv` を選択
3. データインポートダイアログで「区切り記号」を選択 → 次へ → 完了

**手順2: 直接開く**
Finder/エクスプローラーで `output` フォルダを開き、CSVファイルをダブルクリック

### 正常読み込みの確認

正常に読み込まれた場合：
- データが複数列（A列、B列、C列等）に分かれて表示
- A列に「timestamp」、B列に「monitor_name」等の見出しが表示
- 複数行のデータが表示（数百〜数千行）

---

## データ構造の理解

### 主要カラムの定義

| **カラム名** | **内容** | **分析での使用方法** |
|------------|---------|------------------|
| **timestamp** | 測定日時 | 時系列グラフのX軸 |
| **monitor_name** | 監視サイト名 | サイト別フィルタリング |
| **monitor_url** | 監視対象URL | URL確認 |
| **metric_display_name** | 指標名 | 測定内容の特定 |
| **value** | 測定値 | 分析対象の数値データ |
| **unit** | 単位 | ms（ミリ秒）、%等 |

### 重要指標の優先順位

#### **最重要指標（基本分析対象）**
- **ページロード時間** (`actionDuration.load`)
- **可用性** (`availability`)
- **最大コンテンツ描画** (`largestContentfulPaint.load`)

#### **詳細分析用指標**
- **Speed Index** (`speedIndex.load`)
- **初回バイト到達時間** (`firstByte.load`)
- **レイアウトシフト** (`cumulativeLayoutShift.load`)

---

## 基本分析手順

### データテーブル化

1. **全データ選択**: Ctrl+A（全選択）
2. **テーブル変換**: 「データ」タブ → 「テーブルとして書式設定」
3. **見出し設定**: 「先頭行をタイトルとして使用」にチェック → OK

**成功確認**: データにフィルターボタン（▼）が表示される

### フィルター機能の活用

#### **期間による絞り込み**
1. **timestamp**列のフィルターボタン（▼）をクリック
2. **日付フィルター** → **期間を指定**
3. 開始日・終了日を設定してOK

**使用例**: 過去1週間のデータのみを表示

#### **指標による絞り込み**
1. **metric_display_name**列のフィルターボタン（▼）をクリック
2. 分析対象指標のみチェック

**よく使用される例**:
- `ページロード時間` のみ表示
- `可用性` のみ表示

---

## グラフ作成

### 時系列グラフ（基本分析）

**目的**: 時間経過によるパフォーマンス変化の確認

**作成手順**:
1. **データ準備**: 特定指標でフィルタリング（例：ページロード時間）
2. **timestamp列**と**value列**を選択
3. **挿入**タブ → **散布図** → **マーカー付き折れ線**
4. **グラフタイトル**を編集: 「ページロード時間の推移」等

**読み取り方法**:
- **上向き**: パフォーマンス悪化
- **下向き**: パフォーマンス改善
- **ギザギザ**: 不安定
- **平坦**: 安定

### 監視サイト比較グラフ

**目的**: 複数Webサイトのパフォーマンス比較

**作成手順**:
1. **ピボットテーブル作成**: 「挿入」タブ → 「ピボットテーブル」
2. **行**: `monitor_name`（サイト名）
3. **列**: `metric_display_name`（指標名）
4. **値**: `value`（平均を選択）
5. **ピボットグラフ**を追加

---

## 実践的な分析パターン

### 日次パフォーマンス分析

**目的**: 日常的なWebサイト性能チェック

**手順**:
1. 「ページロード時間」でフィルタリング
2. 過去24時間のデータを選択
3. 時系列グラフを作成
4. 異常値（極端に高い値）をチェック

**判定基準**:
- 3000ms以下: 良好
- 3000-5000ms: 注意
- 5000ms超: 要改善

### 可用性監視

**目的**: サイトの正常稼働状況確認

**手順**:
1. 「可用性」でフィルタリング
2. 値が95%未満のデータを確認
3. 問題発生時間帯を特定

### サイト間比較分析

**目的**: 複数サイトの性能比較

**手順**:
1. 特定期間（例：過去1週間）でフィルタリング
2. 各サイトの平均ページロード時間を計算
3. 横棒グラフで比較表示

### 週次・月次レポート作成

**手順**:
1. **週単位**または**月単位**でデータをフィルタリング
2. **平均値**・**最大値**・**最小値**を計算
3. **ピボットテーブル**でサマリー作成
4. **グラフ**を挿入してビジュアル化

**出力例**:
```
サイト名 | 平均ロード時間 | 可用性 | 評価
Site A   | 2,450ms      | 99.2% | Good
Site B   | 4,120ms      | 96.8% | Warning
```

---

## 高度な分析技法

### 条件付き書式の活用

**目的**: 問題データの視覚的強調

**手順**:
1. **value**列を選択
2. **ホーム**タブ → **条件付き書式** → **新しいルール**
3. **数値範囲**に基づく色分けを設定

**結果**:
- 高い値（遅い）が赤色で表示
- 低い値（速い）が緑色で表示

### 統計分析の実施

**基本統計の計算**:
```
平均値: =AVERAGE(F:F)  ※F列がvalue列の場合
最大値: =MAX(F:F)
最小値: =MIN(F:F)
標準偏差: =STDEV(F:F)
```

### 複合グラフの作成

**目的**: 異なる指標の同時表示

**例**: ページロード時間（棒グラフ）+ 可用性（折れ線グラフ）

**手順**:
1. 基本グラフを作成
2. **グラフデザイン** → **グラフの種類の変更**
3. **複合グラフ**を選択

---

## 分析結果の解釈

### パフォーマンス評価基準

#### **良好（Good）**
- **ページロード時間**: 3.0秒以下
- **LCP**: 2.5秒以下
- **可用性**: 99%以上

#### **注意（Warning）**
- **ページロード時間**: 3.0〜5.0秒
- **LCP**: 2.5〜4.0秒
- **可用性**: 95〜99%

#### **要改善（Critical）**
- **ページロード時間**: 5.0秒超
- **LCP**: 4.0秒超
- **可用性**: 95%未満

### トレンド分析

#### **改善傾向**
- グラフが**右下がり**（時間経過とともに値が減少）
- 「最適化作業が効果的」
- 「継続監視が重要」

#### **悪化傾向**
- グラフが**右上がり**（時間経過とともに値が増加）
- 「早急な対策が必要」
- 「原因調査を実施」

#### **パターン分析**
- **平日 vs 週末**の違い
- **時間帯**による違い（朝・昼・夜）
- **月末・月初**等の特定期間の傾向

---

## 実践例

### 実例：「Site Aの性能改善効果検証」

**シナリオ**: Site Aのサーバー増強効果の検証

**分析手順**:
1. **期間設定**: 改善実施前後1週間ずつのデータを取得
2. **指標選択**: ページロード時間、可用性、TTFB（初回バイト時間）
3. **データ比較**:
   ```
   改善前（1週間平均）: 4,200ms
   改善後（1週間平均）: 2,800ms
   改善効果: 33.3%向上
   ```
4. **グラフ作成**: 改善前後の時系列グラフで視覚化
5. **レポート**: 「サーバー増強により平均ロード時間が33%改善」

**結論**: 数値的根拠を持った改善効果の実証完了

---

## 困った時のトラブルシューティング

**Q1: データが表示されない**  
A1: CSVファイルが正しく開けているか確認。「区切り記号」形式でインポートしてください。

**Q2: グラフがうまく表示されない**  
A2: データの選択範囲を確認。timestamp（日時）とvalue（数値）の2列を選択してください。

**Q3: フィルターが効かない**  
A3: データをテーブルに変換してください（Ctrl+A → データタブ → テーブルとして書式設定）。

**Q4: 大量データでExcelが重い**  
A4: 期間を絞って分析するか、重要な指標のみでフィルタリングしてください。

**Q5: 単位が不明**  
A5: unit列を確認してください。ms=ミリ秒、%=パーセント等が表示されています。

---

## まとめ

本ガイドの活用により、以下の分析が可能になります：

**基本分析**: サイトの性能状況把握  
**トレンド分析**: 時間的変化の把握  
**比較分析**: サイト間差異の把握  
**問題発見**: 異常値や課題の特定  
**レポート作成**: 定期報告書作成  

継続的な分析により、Webサイトパフォーマンスの改善に貢献できます。 