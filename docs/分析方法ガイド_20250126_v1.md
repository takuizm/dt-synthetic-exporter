# Excel分析ガイド（非エンジニア向け）
作成日: 2025-01-26  
対象: Excel初心者・非エンジニア  

## このガイドの目的

このガイドでは、Dynatrace Synthetic Browser監視データエクスポーターで生成されたCSVファイルを**Excel**で開いて、実際のWebサイトパフォーマンス分析を行う方法を説明します。

**プログラミング知識は一切不要**で、Excelの基本操作だけで高度な分析ができます。

## **STEP 1: ファイルを開く**

### 1-1. CSVファイルを探す

1. **フォルダを開く**: プロジェクトフォルダの `output/` フォルダを確認
2. **ファイル確認**: `ultimate_browser_results_YYYYMMDD_HHMMSS.csv` という形式のファイルを探す
3. **最新ファイル**: 日付・時刻が最新のものが最新の分析結果

### 1-2. Excelで開く

**方法1: Excelから開く**
1. **Excel**を起動
2. **ファイル** → **開く** → `ultimate_browser_results_*.csv` を選択
3. **データインポート**ダイアログが出たら「**区切り記号**」を選択 → **次へ** → **完了**

**または：** Finderで `output` フォルダを開き、CSVファイルをダブルクリック

### 1-3. 正常に開けたかチェック

**正常に開けた場合**:
- データが複数の列（A列、B列、C列...）に分かれて表示される
- A列に「timestamp」、B列に「monitor_name」などの見出しが表示される
- 複数行のデータが表示される（数百〜数千行）

---

## **STEP 2: データ構造を理解する**

### 2-1. 主要なカラム（列）の意味

| **カラム名** | **意味** | **活用方法** |
|------------|---------|-------------|
| **timestamp** | 測定日時 | 時系列グラフのX軸 |
| **monitor_name** | 監視サイト名 | サイト別フィルタリング |
| **monitor_url** | 監視対象URL | URLの確認 |
| **metric_display_name** | 指標名 | 何を測定しているか |
| **value** | 測定値 | 分析する数値データ |
| **unit** | 単位 | ms（ミリ秒）、%等 |
| **performance_status** | 評価 | Good/Warning/Critical |

### 2-2. 重要指標の優先順位

#### **最重要指標（まずこれを見る）**
- **ページロード時間** (`actionDuration.load`)
- **可用性** (`availability`)
- **最大コンテンツ描画** (`largestContentfulPaint.load`)

#### **詳細分析用指標**
- **Speed Index** (`speedIndex.load`)
- **初回バイト到達時間** (`firstByte.load`)
- **レイアウトシフト** (`cumulativeLayoutShift.load`)

---

## **STEP 3: 基本的な分析手順**

### 3-1. データをテーブルに変換

1. **データ全体を選択**: Ctrl+A（全選択）
2. **テーブル化**: 「データ」タブ → 「テーブルとして書式設定」
3. **先頭行をタイトルとして使用**にチェック → **OK**

**成功**: データにフィルターボタン（▼）が表示される

### 3-2. フィルター機能の使い方

#### **期間で絞り込み**
1. **timestamp**列のフィルターボタン（▼）をクリック
2. **日付フィルター** → **期間を指定**
3. 開始日・終了日を設定して**OK**

**例**: 過去1週間のデータのみを表示

#### **特定指標で絞り込み**
1. **metric_display_name**列のフィルターボタン（▼）をクリック
2. 分析したい指標のみチェック

**よく使う例**:
- `ページロード時間` のみ表示
- `可用性` のみ表示

---

## **STEP 4: グラフ作成**

### 4-1. 時系列グラフ（最も重要）

**目的**: 時間経過によるパフォーマンスの変化を確認

**手順**:
1. **データを準備**: 特定指標でフィルタリング（例：ページロード時間）
2. **timestamp列**と**value列**を選択
3. **挿入**タブ → **散布図** → **マーカー付き折れ線**
4. **グラフタイトル**を編集: 「ページロード時間の推移」など

**読み方**:
- **上向き**: パフォーマンス悪化
- **下向き**: パフォーマンス改善
- **ギザギザ**: 不安定
- **平坦**: 安定

### 4-2. 監視サイト比較グラフ

**目的**: 複数のWebサイトのパフォーマンスを比較

**手順**:
1. **ピボットテーブル作成**: 「挿入」タブ → 「ピボットテーブル」
2. **行**: `monitor_name`（サイト名）
3. **列**: `metric_display_name`（指標名）
4. **値**: `value`（平均を選択）
5. **ピボットグラフ**を追加

---

## **STEP 5: 具体的な分析パターン**

### 5-1. **日次パフォーマンス分析**

**目的**: 毎日のWebサイト性能をチェック

**手順**:
1. 「ページロード時間」でフィルタリング
2. 過去24時間のデータを選択
3. 時系列グラフを作成
4. 異常値（極端に高い値）をチェック

**判断基準**:
- 3000ms以下 = 良好
- 3000-5000ms = 注意
- 5000ms超 = 要改善

### 5-2. 可用性監視

**目的**: サイトが正常に動作しているかチェック

**手順**:
1. 「可用性」でフィルタリング
2. `performance_status`列で「Critical」をチェック
3. 問題のある時間帯を特定

### 5-3. サイト間比較

**目的**: 複数サイトの性能を比較

**手順**:
1. 特定期間（例：過去1週間）でフィルタリング
2. 各サイトの平均ページロード時間を計算
3. 横棒グラフで比較表示

### 5-4. **週次・月次レポート作成**

**手順**:
1. **週単位**または**月単位**でデータをフィルタリング
2. **平均値**・**最大値**・**最小値**を計算
3. **ピボットテーブル**でサマリー作成
4. **グラフ**を挿入してビジュアル化

**出力例**:
```
サイト名 | 平均ロード時間 | 可用性 | 評価
Site A   | 2,450ms      | 99.2% | Good
Site B   | 4,120ms      | 96.8% | Warning
```

---

## **STEP 6: 高度な分析テクニック**

### 6-1. 条件付き書式

**目的**: 問題のあるデータを視覚的に強調

**手順**:
1. **value**列を選択
2. **ホーム**タブ → **条件付き書式** → **新しいルール**
3. **数値範囲**に基づく色分けを設定

**結果**:
- 高い値（遅い）が赤色で表示
- 低い値（速い）が緑色で表示

### 6-2. データの統計分析

**基本統計の計算**:
```
平均値: =AVERAGE(F:F)  ※F列がvalue列の場合
最大値: =MAX(F:F)
最小値: =MIN(F:F)
標準偏差: =STDEV(F:F)
```

### 6-3. 複合グラフ

**目的**: 異なる指標を1つのグラフで表示

**例**: ページロード時間（棒グラフ）+ 可用性（折れ線グラフ）

**手順**:
1. 基本グラフを作成
2. **グラフデザイン** → **グラフの種類の変更**
3. **複合グラフ**を選択

---

## **STEP 7: 分析結果の読み方**

### 7-1. パフォーマンス評価基準

#### **Good（良好）**
- **ページロード時間**: 3.0秒以下
- **LCP**: 2.5秒以下
- **可用性**: 99%以上

#### **Warning（注意）**
- **ページロード時間**: 3.0〜5.0秒
- **LCP**: 2.5〜4.0秒
- **可用性**: 95〜99%

#### **Critical（要改善）**
- **ページロード時間**: 5.0秒超
- **LCP**: 4.0秒超
- **可用性**: 95%未満

### 7-2. トレンド分析

#### **改善傾向**
- グラフが**右下がり**（時間の経過とともに値が減少）
- 「最適化作業が効果的」
- 「継続監視が重要」

#### **悪化傾向**
- グラフが**右上がり**（時間の経過とともに値が増加）
- 「早急な対策が必要」
- 「原因調査を実施」

#### **季節性パターン**
- **平日 vs 週末**の違い
- **時間帯**による違い（朝・昼・夜）
- **月末・月初**などの特定期間の傾向

---

## **STEP 8: 実践例**

### 実例：「Site Aの性能改善効果検証」

**シナリオ**: Site Aのサーバーを増強した効果を検証したい

**分析手順**:
1. **期間設定**: 改善実施前後1週間ずつのデータを取得
2. **指標選択**: ページロード時間、可用性、TTFB（初回バイト時間）
3. **データ比較**:
   ```
   改善前（1週間平均）: 4,200ms
   改善後（1週間平均）: 2,800ms
   改善効果: 33.3%向上
   ```
4. **グラフ作成**: 改善前後の時系列グラフで視覚化
5. **レポート**: 「サーバー増強により平均ロード時間が33%改善」

**結論**: 数値的根拠を持った改善効果の実証完了

---

## **困ったときのQ&A**

**Q1: データが表示されない**  
A1: CSVファイルが正しく開けているか確認。「区切り記号」形式でインポートしてください。

**Q2: グラフがうまく表示されない**  
A2: データの選択範囲を確認。timestamp（日時）とvalue（数値）の2列を選択してください。

**Q3: フィルターが効かない**  
A3: データをテーブルに変換してください（Ctrl+A → データタブ → テーブルとして書式設定）。

**Q4: 大量データでExcelが重い**  
A4: 期間を絞って分析するか、重要な指標のみでフィルタリングしてください。

**Q5: performance_statusが空白**  
A5: 一部の指標では評価基準が設定されていません。valueの数値を直接評価してください。

**Q6: 単位が分からない**  
A6: unit列を確認してください。ms=ミリ秒、%=パーセント等が表示されています。

---

## **まとめ**

このガイドを使用することで、以下の分析ができるようになります：

**基本分析**: サイトの性能状況を把握  
**トレンド分析**: 時間的な変化を把握  
**比較分析**: サイト間の差異を把握  
**問題発見**: 異常値や課題を特定  
**レポート作成**: 定期的な報告書作成  

**これでExcelを使ったWebサイトパフォーマンス分析の専門家です！** 