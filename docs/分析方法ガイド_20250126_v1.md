# 📊 Excel分析ガイド（非エンジニア向け）
作成日: 2025-01-26  
対象: Excel初心者〜中級者  

## 🎯 このガイドの目的

CSVファイルを使ってExcelで簡単に**Webサイトパフォーマンス分析**を行う方法を説明します。  
技術的な知識は不要です！

---

## 📂 **STEP 1: ファイルを開く**

### 1-1. CSVファイルの場所
```bash
# ターミナルで出力ファイルを確認
ls -la output/
```

### 1-2. Excelで開く
```bash
# 最新のCSVファイルを開く
open output/ultimate_browser_results_*.csv
```

**💡 または：** Finderで `output` フォルダを開き、CSVファイルをダブルクリック

### 1-3. Excelでの表示確認
✅ **正常に開けた場合**:
- 多数の行とカラムがある表が表示される
- 日時データ、サイト名、数値データが見える

---

## 📋 **STEP 2: データ構造を理解する**

### 2-1. 重要なカラム（列）説明

| カラム名 | 意味 | 分析での使い方 |
|---------|------|---------------|
| **timestamp** | 測定日時 | 📈 時系列グラフのX軸 |
| **monitor_name** | 監視サイト名 | 🔍 サイト別フィルタリング |
| **monitor_url** | サイトURL | 🌐 どのサイトか確認 |
| **metric_display_name** | 指標名 | 📊 何を測定しているか |
| **value** | 測定値 | 📈 分析する数値データ |
| **unit** | 単位 | ⏱️ ms（ミリ秒）、%等 |
| **performance_status** | 評価 | 🚦 Good/Warning/Critical |

### 2-2. 重要な指標（メトリクス）

#### 🟢 **最重要指標（まずこれを見る）**
- **ページロード時間**: サイトが完全に表示されるまでの時間
- **可用性**: サイトが正常にアクセスできた割合
- **LCP**: 最大コンテンツが表示されるまでの時間（Google重視）

#### 🟡 **詳細分析用指標**
- **Speed Index**: ページの見た目の読み込み速度
- **TTFB**: サーバーからの応答速度
- **CLS**: ページのレイアウト崩れ具合

---

## 🛠️ **STEP 3: 基本的な分析手順**

### 3-1. データをテーブル化

1. **データ全体を選択**: `Ctrl+A` (Windows) または `Cmd+A` (Mac)
2. **データタブ** → **テーブルとして書式設定**
3. **先頭行をテーブルの見出しとして使用** にチェック
4. **OK** をクリック

✅ **成功**: データにフィルターボタン（▼）が表示される

### 3-2. 基本フィルタリング

#### 📅 **期間で絞り込み**
1. `timestamp` カラムの **▼** をクリック
2. **日付フィルター** → **指定の期間**
3. 分析したい期間を選択

#### 🌐 **特定サイトで絞り込み**
1. `monitor_name` カラムの **▼** をクリック
2. 分析したいサイト名にのみチェック
3. **OK** をクリック

#### 📊 **特定指標で絞り込み**
1. `metric_display_name` カラムの **▼** をクリック
2. 分析したい指標（例：ページロード時間）にのみチェック
3. **OK** をクリック

#### 🚦 **問題のあるデータで絞り込み**
1. `performance_status` カラムの **▼** をクリック
2. **Critical** または **Warning** にのみチェック
3. **OK** をクリック

---

## 📈 **STEP 4: グラフ作成**

### 4-1. 時系列グラフ（トレンド分析）

#### **準備**
1. 特定の指標でフィルタリング（例：ページロード時間）
2. 必要なデータのみ表示させる

#### **グラフ作成**
1. `timestamp` と `value` カラムを選択
2. **挿入タブ** → **グラフ** → **散布図** → **直線とマーカー**
3. **グラフタイトル**を分かりやすく変更

#### **グラフ読み方**
- 📈 **上向き**: パフォーマンス悪化
- 📉 **下向き**: パフォーマンス改善
- 📏 **平行**: 安定

### 4-2. サイト比較グラフ

#### **準備**
1. 特定の指標でフィルタリング（例：ページロード時間）
2. 複数サイトのデータを表示

#### **平均値算出**
1. 新しい列に以下の式を入力:
   ```excel
   =AVERAGEIFS(value列, monitor_name列, "サイト名A")
   ```
2. 各サイトの平均値を計算

#### **グラフ作成**
1. サイト名と平均値を選択
2. **挿入タブ** → **グラフ** → **縦棒グラフ**
3. **グラフタイトル**を分かりやすく変更

---

## 🔍 **STEP 5: 具体的な分析パターン**

### 5-1. 📊 **日次パフォーマンス分析**

#### **目的**: 毎日のサイト性能をチェック

#### **手順**
1. **フィルタ設定**:
   - `metric_display_name` = "ページロード時間"
   - `timestamp` = 過去24時間
2. **時系列グラフ作成**
3. **評価**:
   - 3000ms以下 = 🟢 良好
   - 3000-5000ms = 🟡 注意
   - 5000ms超 = 🔴 要改善

### 5-2. 🚦 **問題の早期発見**

#### **目的**: 異常値やエラーを素早く特定

#### **手順**
1. **フィルタ設定**:
   - `performance_status` = "Critical"
2. **Critical数の多い指標を確認**
3. **該当する時間帯とサイトを特定**
4. **原因調査の指針とする**

### 5-3. 🌐 **サイト間比較分析**

#### **目的**: 複数サイトの性能差を把握

#### **手順**
1. **ピボットテーブル作成**:
   - 行: `monitor_name`
   - 列: `metric_display_name`
   - 値: `value` の平均
2. **ヒートマップ作成**（条件付き書式）
3. **性能の良い/悪いサイトを特定**

### 5-4. 📅 **週次・月次レポート作成**

#### **目的**: 定期的な性能報告書作成

#### **手順**
1. **期間設定**: 週次または月次期間
2. **主要指標のサマリー**:
   - 平均ページロード時間
   - 可用性の平均
   - Critical発生回数
3. **前期間との比較**
4. **改善/悪化トレンドの把握**

---

## 📊 **STEP 6: 高度な分析テクニック**

### 6-1. 条件付き書式でデータ可視化

#### **設定方法**
1. `value` カラムを選択
2. **ホームタブ** → **条件付き書式** → **カラースケール**
3. **赤-黄-緑** を選択

#### **効果**
- 🔴 高い値（遅い）が赤色で表示
- 🟢 低い値（速い）が緑色で表示
- 一目で問題箇所を特定可能

### 6-2. ピボットテーブルで集計分析

#### **作成手順**
1. データ全体を選択
2. **挿入タブ** → **ピボットテーブル**
3. **設定例**:
   - 行: `monitor_name`, `metric_display_name`
   - 値: `value` の平均、最大、最小

#### **活用方法**
- サイト別・指標別の統計表示
- 異常値の特定
- 全体傾向の把握

### 6-3. 条件付きフィルタリング

#### **複合条件例**
```
performance_status = "Critical" 
AND 
metric_display_name = "ページロード時間"
AND
timestamp >= 今日-7日
```

#### **効果**
過去1週間の重大なパフォーマンス問題を特定

---

## 💡 **STEP 7: 分析結果の読み方**

### 7-1. パフォーマンス評価基準

#### 🟢 **Good（良好）**
- **ページロード時間**: 3秒以下
- **LCP**: 2.5秒以下  
- **可用性**: 99%以上
- **TTFB**: 0.8秒以下

#### 🟡 **Warning（注意）**
- **ページロード時間**: 3-5秒
- **LCP**: 2.5-4.0秒
- **可用性**: 95-99%
- **TTFB**: 0.8-1.8秒

#### 🔴 **Critical（要改善）**
- **ページロード時間**: 5秒超
- **LCP**: 4.0秒超
- **可用性**: 95%未満
- **TTFB**: 1.8秒超

### 7-2. トレンド分析のポイント

#### 📈 **改善傾向**
- 値が時間と共に減少
- Critical発生回数の減少
- Good評価の増加

#### 📉 **悪化傾向**  
- 値が時間と共に増加
- Critical発生回数の増加
- Good評価の減少

#### 📊 **季節性パターン**
- 特定時間帯の性能低下
- 曜日による変動
- 月次・週次の周期性

---

## 🚀 **STEP 8: 実践例**

### 8-1. 「サイトAの性能が最近悪い」調査

#### **分析手順**
1. **サイトAでフィルタリング**
2. **過去30日の時系列グラフ作成**
3. **悪化開始時期を特定**
4. **該当期間のCritical指標を確認**
5. **具体的な問題指標を特定**

### 8-2. 「全サイトの今月レポート」作成

#### **分析手順**
1. **今月のデータでフィルタリング**
2. **ピボットテーブルでサイト別集計**
3. **主要指標の平均値を算出**
4. **前月との比較表を作成**
5. **改善/悪化サイトを特定**

### 8-3. 「特定時間帯の性能問題」調査

#### **分析手順**
1. **問題発生時間帯でフィルタリング**
2. **全サイトの該当時間データを表示**
3. **影響を受けた指標を特定**
4. **サイト別影響度を比較**
5. **原因仮説を立てる**

---

## 📞 **困ったときのQ&A**

### Q: グラフがうまく作れない
**A**: データの型を確認してください
- `timestamp`が日付型になっているか
- `value`が数値型になっているか

### Q: フィルタが効かない
**A**: テーブル化されているか確認
- データタブ → テーブルとして書式設定

### Q: 数値が正しく表示されない
**A**: 単位を確認
- ms（ミリ秒）→ 秒に変換: `=value/1000`
- %（パーセント）→ そのまま使用

### Q: データが多すぎて重い
**A**: 必要な期間・サイトでフィルタリング
- 期間を短く設定
- 特定サイトのみ分析

---

## 🎉 **まとめ**

このガイドを使用することで：

✅ **基本分析**: サイトの性能状況を把握  
✅ **トレンド分析**: 時間的な変化を把握  
✅ **比較分析**: サイト間の差異を把握  
✅ **問題発見**: 異常値や課題を特定  
✅ **レポート作成**: 定期的な報告書作成  

**🚀 これでExcelを使ったWebサイトパフォーマンス分析の専門家です！** 